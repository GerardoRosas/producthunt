{"ast":null,"code":"var _jsxFileName = \"/Users/gerardorosas/Documents/producthunt/pages/nuevo-producto.js\";\nvar __jsx = React.createElement;\n\nfunction _EMOTION_STRINGIFIED_CSS_ERROR__() { return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\"; }\n\nimport React, { Fragment, useState, useContext } from 'react';\nimport { css } from '@emotion/core';\nimport Layout from '../components/layout/Layout';\nimport Router, { useRouter } from 'next/router';\nimport { Formulario, Campo, InputSubmit, Errores } from '../components/UI/Formulario';\nimport { FirebaseContext } from '../firebase';\nimport FileUploader from 'react-firebase-file-uploader';\nimport useValidacion from '../hooks/useValidacion';\nimport validarCrearProducto from '../validacion/validarCrearProducto';\nimport { jsx as ___EmotionJSX } from \"@emotion/core\";\nconst STATE_INICIAL = {\n  nombre: '',\n  empresa: '',\n  //imagen: '',\n  url: '',\n  descripcion: ''\n};\n\nvar _ref = false ? {\n  name: \"a6z53d-NuevoProducto\",\n  styles: \"text-align:center;margin-top:5rem;;label:NuevoProducto;\"\n} : {\n  name: \"a6z53d-NuevoProducto\",\n  styles: \"text-align:center;margin-top:5rem;;label:NuevoProducto;\",\n  map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9nZXJhcmRvcm9zYXMvRG9jdW1lbnRzL3Byb2R1Y3RodW50L3BhZ2VzL251ZXZvLXByb2R1Y3RvLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQStGb0IiLCJmaWxlIjoiL1VzZXJzL2dlcmFyZG9yb3Nhcy9Eb2N1bWVudHMvcHJvZHVjdGh1bnQvcGFnZXMvbnVldm8tcHJvZHVjdG8uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgRnJhZ21lbnQsIHVzZVN0YXRlLCB1c2VDb250ZXh0IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgY3NzIH0gZnJvbSAnQGVtb3Rpb24vY29yZSc7XG5pbXBvcnQgTGF5b3V0IGZyb20gJy4uL2NvbXBvbmVudHMvbGF5b3V0L0xheW91dCc7XG5pbXBvcnQgUm91dGVyLCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJztcbmltcG9ydCB7IEZvcm11bGFyaW8sIENhbXBvLCBJbnB1dFN1Ym1pdCwgRXJyb3JlcyB9IGZyb20gJy4uL2NvbXBvbmVudHMvVUkvRm9ybXVsYXJpbyc7XG5pbXBvcnQgeyBGaXJlYmFzZUNvbnRleHQgfSBmcm9tICcuLi9maXJlYmFzZSc7XG5pbXBvcnQgRmlsZVVwbG9hZGVyIGZyb20gJ3JlYWN0LWZpcmViYXNlLWZpbGUtdXBsb2FkZXInO1xuXG5pbXBvcnQgdXNlVmFsaWRhY2lvbiBmcm9tICcuLi9ob29rcy91c2VWYWxpZGFjaW9uJztcbmltcG9ydCB2YWxpZGFyQ3JlYXJQcm9kdWN0byBmcm9tICcuLi92YWxpZGFjaW9uL3ZhbGlkYXJDcmVhclByb2R1Y3RvJztcblxuY29uc3QgU1RBVEVfSU5JQ0lBTCA9IHtcbiAgbm9tYnJlOiAnJyxcbiAgZW1wcmVzYTogJycsXG4gIC8vaW1hZ2VuOiAnJyxcbiAgdXJsOiAnJyxcbiAgZGVzY3JpcGNpb246ICcnXG59XG5cbmNvbnN0IE51ZXZvUHJvZHVjdG8gPSAoKSA9PiB7XG5cbiAgLy9TdGF0ZSBkZSBsYXMgaW1hZ25lc1xuICBjb25zdCBbIG5vbWJyZWltYWdlbiwgZ3VhcmRhck5vbWJyZSBdID0gdXNlU3RhdGUoJycpO1xuICBjb25zdCBbIHN1YmllbmRvLCBndWFyZGFyU3ViaWVuZG8gXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgWyBwcm9ncmVzbywgZ3VhcmRhclByb2dyZXNvIF0gPSB1c2VTdGF0ZSgwKTtcbiAgY29uc3QgWyB1cmxJbWFnZW4sIGd1YXJkYXJVcmxJbWFnZW4gXSA9IHVzZVN0YXRlKCcnKTtcbiAgXG4gIGNvbnN0IFsgZXJyb3IsIGd1YXJkYXJFcnJvciBdID0gdXNlU3RhdGUoJycpO1xuXG4gIGNvbnN0IHt2YWxvcmVzLCBlcnJvcmVzLCBoYW5kbGVDaGFuZ2UsIGhhbmRsZVN1Ym1pdCwgaGFuZGxlQmx1cn0gPSB1c2VWYWxpZGFjaW9uXG4gIChTVEFURV9JTklDSUFMLCB2YWxpZGFyQ3JlYXJQcm9kdWN0bywgY3JlYXJQcm9kdWN0byk7XG5cbiAgY29uc3R7IG5vbWJyZSwgZW1wcmVzYSwgaW1hZ2VuLCB1cmwsIGRlc2NyaXBjaW9uIH0gPSB2YWxvcmVzO1xuXG4gIC8vSG9vayBkZSByb3V0aW5nIHBhcmEgcmVkaXJlY2Npb25hclxuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcblxuICAvL0NvbnRleHQgY29uIGxhcyBvcGVyYWNpb25lcyBjcnVkIGRlIGZpcmViYXNlXG4gIGNvbnN0IHsgdXN1YXJpbywgZmlyZWJhc2UgfSA9IHVzZUNvbnRleHQoRmlyZWJhc2VDb250ZXh0KTtcblxuICBhc3luYyBmdW5jdGlvbiBjcmVhclByb2R1Y3RvKCl7XG4gICAgLy9TaSBlbCB1c3VhcmlvIG5vIGVzdGEgYXVudGVudGljYWRvIGxsZXZhciBhbCBsb2dpblxuICAgIGlmKCF1c3VhcmlvKSB7XG4gICAgICByZXR1cm4gcm91dGVyLnB1c2goJy9sb2dpbicpO1xuICAgIH0gXG5cbiAgICAvL0NyZWFyIGVsIG9iamV0byBkZSBudWV2byBwcm9kdWN0b1xuICAgIGNvbnN0IHByb2R1Y3RvID0ge1xuICAgICAgbm9tYnJlLFxuICAgICAgZW1wcmVzYSxcbiAgICAgIHVybCxcbiAgICAgIHVybEltYWdlbixcbiAgICAgIGRlc2NyaXBjaW9uLFxuICAgICAgdm90b3M6IDAsXG4gICAgICBjb21lbnRhcmlvcyA6IFtdLFxuICAgICAgY3JlYWRvOiBEYXRlLm5vdygpXG4gICAgfVxuXG4gICAgLy9JbnNlcnRhcmxvIGVuIGxhIGJhc2UgZGUgZGF0b3NcbiAgICBmaXJlYmFzZS5kYi5jb2xsZWN0aW9uKCdwcm9kdWN0b3MnKS5hZGQocHJvZHVjdG8pO1xuXG4gIH1cblxuICBjb25zdCBoYW5kbGVVcGxvYWRTdGFydCA9ICgpID0+IHtcbiAgICBndWFyZGFyUHJvZ3Jlc28oMCk7XG4gICAgZ3VhcmRhclN1YmllbmRvKHRydWUpO1xuICB9XG5cbiAgY29uc3QgaGFuZGxlUHJvZ3Jlc3MgPSBwcm9ncmVzbyA9PiBndWFyZGFyUHJvZ3Jlc28oeyBwcm9ncmVzbyB9KTtcblxuICBjb25zdCBoYW5kbGVVcGxvYWRFcnJvciA9IGVycm9yID0+IHtcbiAgICAgIGd1YXJkYXJTdWJpZW5kbyhlcnJvcik7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVVcGxvYWRTdWNjZXNzID0gbm9tYnJlID0+IHtcbiAgICAgIGd1YXJkYXJQcm9ncmVzbygxMDApO1xuICAgICAgZ3VhcmRhclN1YmllbmRvKGZhbHNlKTtcbiAgICAgIGd1YXJkYXJOb21icmUobm9tYnJlKVxuICAgICAgZmlyZWJhc2VcbiAgICAgICAgICAuc3RvcmFnZVxuICAgICAgICAgIC5yZWYoXCJwcm9kdWN0b3NcIilcbiAgICAgICAgICAuY2hpbGQobm9tYnJlKVxuICAgICAgICAgIC5nZXREb3dubG9hZFVSTCgpXG4gICAgICAgICAgLnRoZW4odXJsID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVybCk7XG4gICAgICAgICAgICBndWFyZGFyVXJsSW1hZ2VuKHVybCk7XG4gICAgICAgICAgfSApO1xuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdj5cbiAgICAgIDxMYXlvdXQ+XG4gICAgICAgIDxGcmFnbWVudD5cbiAgICAgICAgICA8aDFcbiAgICAgICAgICAgIGNzcz17Y3NzYFxuICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgICAgIG1hcmdpbi10b3A6IDVyZW07XG4gICAgICAgICAgICBgfVxuICAgICAgICAgID5OdWV2byBQcm9kdWN0bzwvaDE+XG4gICAgICAgICAgPEZvcm11bGFyaW9cbiAgICAgICAgICAgIG9uU3VibWl0PXtoYW5kbGVTdWJtaXR9XG4gICAgICAgICAgICBub1ZhbGlkYXRlXG4gICAgICAgICAgPlxuXG4gICAgICAgICAgICA8ZmllbGRzZXQ+XG4gICAgICAgICAgICAgIDxsZWdlbmQ+SW5mb3JtYWNpw7NuIGRlbCBQcm9kdWN0bzwvbGVnZW5kPlxuICAgICAgICAgICAgXG4gICAgICAgICAgICAgIDxDYW1wbz5cbiAgICAgICAgICAgICAgICA8bGFiZWwgaHRtbEZvcj1cIm5vbWJyZVwiPk5vbWJyZTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICBpZD1cIm5vbWJyZVwiICAgXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlR1IG5vbWJyZVwiXG4gICAgICAgICAgICAgICAgICBuYW1lPVwibm9tYnJlXCJcbiAgICAgICAgICAgICAgICAgIHZhbHVlPXtub21icmV9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgb25CbHVyPXtoYW5kbGVCbHVyfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvQ2FtcG8+XG5cbiAgICAgICAgICAgICAge2Vycm9yZXMubm9tYnJlICYmIDxFcnJvcmVzPntlcnJvcmVzLm5vbWJyZX08L0Vycm9yZXM+fVxuICAgIFxuICAgICAgICAgICAgICA8Q2FtcG8+XG4gICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJlbXByZXNhXCI+RW1wcmVzYTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICBpZD1cImVtcHJlc2FcIlxuICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJOb21icmUgRW1wcmVzYSBvIENvbXBhbsOtYVwiXG4gICAgICAgICAgICAgICAgICBuYW1lPVwiZW1wcmVzYVwiXG4gICAgICAgICAgICAgICAgICB2YWx1ZT17ZW1wcmVzYX1cbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICBvbkJsdXI9e2hhbmRsZUJsdXJ9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9DYW1wbz5cblxuICAgICAgICAgICAgICB7ZXJyb3Jlcy5lbXByZXNhICYmIDxFcnJvcmVzPntlcnJvcmVzLmVtcHJlc2F9PC9FcnJvcmVzPn1cblxuICAgICAgICAgICAgICA8Q2FtcG8+XG4gICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJpbWFnZW5cIj5JbWFnZW48L2xhYmVsPlxuICAgICAgICAgICAgICAgIDxGaWxlVXBsb2FkZXJcbiAgICAgICAgICAgICAgICAgIGFjY2VwdD1cImltYWdlLypcIlxuICAgICAgICAgICAgICAgICAgaWQ9XCJpbWFnZW5cIlxuICAgICAgICAgICAgICAgICAgbmFtZT1cImltYWdlblwiXG4gICAgICAgICAgICAgICAgICByYW5kb21pemVGaWxlbmFtZVxuICAgICAgICAgICAgICAgICAgc3RvcmFnZVJlZj17ZmlyZWJhc2Uuc3RvcmFnZS5yZWYoXCJwcm9kdWN0b3NcIil9XG4gICAgICAgICAgICAgICAgICBvblVwbG9hZFN0YXJ0PXtoYW5kbGVVcGxvYWRTdGFydH1cbiAgICAgICAgICAgICAgICAgIG9uVXBsb2FkRXJyb3I9e2hhbmRsZVVwbG9hZEVycm9yfVxuICAgICAgICAgICAgICAgICAgb25VcGxvYWRTdWNjZXNzPXtoYW5kbGVVcGxvYWRTdWNjZXNzfVxuICAgICAgICAgICAgICAgICAgb25Qcm9ncmVzcz17aGFuZGxlUHJvZ3Jlc3N9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9DYW1wbz5cblxuICAgICAgICAgICAgICA8Q2FtcG8+XG4gICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ1cmxcIj5VUkw8L2xhYmVsPlxuICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgdHlwZT1cInVybFwiXG4gICAgICAgICAgICAgICAgICBpZD1cInVybFwiXG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlVSTCBkZSB0dSBwcm9kdWN0b1wiXG4gICAgICAgICAgICAgICAgICBuYW1lPVwidXJsXCJcbiAgICAgICAgICAgICAgICAgIHZhbHVlPXt1cmx9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgb25CbHVyPXtoYW5kbGVCbHVyfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvQ2FtcG8+XG5cbiAgICAgICAgICAgICAge2Vycm9yZXMudXJsICYmIDxFcnJvcmVzPntlcnJvcmVzLnVybH08L0Vycm9yZXM+fSAgXG5cbiAgICAgICAgICAgIDwvZmllbGRzZXQ+XG5cbiAgICAgICAgICAgIDxmaWVsZHNldD5cbiAgICAgICAgICAgICAgPGxlZ2VuZD5Tb2JyZSB0dSBwcm9kdWN0bzwvbGVnZW5kPlxuXG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICA8Q2FtcG8+XG4gICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJkZXNjcmlwY2lvblwiPkRlc2NyaXBjacOzbjwvbGFiZWw+XG4gICAgICAgICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIGlkPVwiZGVzY3JpcGNpb25cIlxuICAgICAgICAgICAgICAgICAgbmFtZT1cImRlc2NyaXBjaW9uXCJcbiAgICAgICAgICAgICAgICAgIHZhbHVlPXtkZXNjcmlwY2lvbn1cbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICBvbkJsdXI9e2hhbmRsZUJsdXJ9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9DYW1wbz5cblxuICAgICAgICAgICAgICB7ZXJyb3Jlcy5kZXNjcmlwY2lvbiAmJiA8RXJyb3Jlcz57ZXJyb3Jlcy5kZXNjcmlwY2lvbn08L0Vycm9yZXM+fVxuICAgICAgICAgICAgPC9maWVsZHNldD5cblxuXG5cbiAgICAgICAgICAgIHtlcnJvciAmJiA8RXJyb3Jlcz57ZXJyb3J9PC9FcnJvcmVzPn1cbiAgXG4gICAgICAgICAgICA8SW5wdXRTdWJtaXRcbiAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgIHZhbHVlPVwiQ3JlYXIgUHJvZHVjdG9cIlxuICAgICAgICAgICAgLz5cbiAgXG4gICAgICAgICAgPC9Gb3JtdWxhcmlvPlxuICAgICAgICA8L0ZyYWdtZW50PlxuICAgICAgPC9MYXlvdXQ+XG4gICAgICAgIFxuICAgIDwvZGl2PlxuICApXG59XG5cbmV4cG9ydCBkZWZhdWx0IE51ZXZvUHJvZHVjdG87Il19 */\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nconst NuevoProducto = () => {\n  //State de las imagnes\n  const {\n    0: nombreimagen,\n    1: guardarNombre\n  } = useState('');\n  const {\n    0: subiendo,\n    1: guardarSubiendo\n  } = useState(false);\n  const {\n    0: progreso,\n    1: guardarProgreso\n  } = useState(0);\n  const {\n    0: urlImagen,\n    1: guardarUrlImagen\n  } = useState('');\n  const {\n    0: error,\n    1: guardarError\n  } = useState('');\n  const {\n    valores,\n    errores,\n    handleChange,\n    handleSubmit,\n    handleBlur\n  } = useValidacion(STATE_INICIAL, validarCrearProducto, crearProducto);\n  const {\n    nombre,\n    empresa,\n    imagen,\n    url,\n    descripcion\n  } = valores; //Hook de routing para redireccionar\n\n  const router = useRouter(); //Context con las operaciones crud de firebase\n\n  const {\n    usuario,\n    firebase\n  } = useContext(FirebaseContext);\n\n  async function crearProducto() {\n    //Si el usuario no esta auntenticado llevar al login\n    if (!usuario) {\n      return router.push('/login');\n    } //Crear el objeto de nuevo producto\n\n\n    const producto = {\n      nombre,\n      empresa,\n      url,\n      urlImagen,\n      descripcion,\n      votos: 0,\n      comentarios: [],\n      creado: Date.now()\n    }; //Insertarlo en la base de datos\n\n    firebase.db.collection('productos').add(producto);\n  }\n\n  const handleUploadStart = () => {\n    guardarProgreso(0);\n    guardarSubiendo(true);\n  };\n\n  const handleProgress = progreso => guardarProgreso({\n    progreso\n  });\n\n  const handleUploadError = error => {\n    guardarSubiendo(error);\n    console.error(error);\n  };\n\n  const handleUploadSuccess = nombre => {\n    guardarProgreso(100);\n    guardarSubiendo(false);\n    guardarNombre(nombre);\n    firebase.storage.ref(\"productos\").child(nombre).getDownloadURL().then(url => {\n      console.log(url);\n      guardarUrlImagen(url);\n    });\n  };\n\n  return ___EmotionJSX(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 5\n    }\n  }, ___EmotionJSX(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }\n  }, ___EmotionJSX(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, ___EmotionJSX(\"h1\", {\n    css: _ref,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }, \"Nuevo Producto\"), ___EmotionJSX(Formulario, {\n    onSubmit: handleSubmit,\n    noValidate: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, ___EmotionJSX(\"fieldset\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, ___EmotionJSX(\"legend\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 15\n    }\n  }, \"Informaci\\xF3n del Producto\"), ___EmotionJSX(Campo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 15\n    }\n  }, ___EmotionJSX(\"label\", {\n    htmlFor: \"nombre\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 17\n    }\n  }, \"Nombre\"), ___EmotionJSX(\"input\", {\n    type: \"text\",\n    id: \"nombre\",\n    placeholder: \"Tu nombre\",\n    name: \"nombre\",\n    value: nombre,\n    onChange: handleChange,\n    onBlur: handleBlur,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 17\n    }\n  })), errores.nombre && ___EmotionJSX(Errores, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 34\n    }\n  }, errores.nombre), ___EmotionJSX(Campo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 15\n    }\n  }, ___EmotionJSX(\"label\", {\n    htmlFor: \"empresa\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 17\n    }\n  }, \"Empresa\"), ___EmotionJSX(\"input\", {\n    type: \"text\",\n    id: \"empresa\",\n    placeholder: \"Nombre Empresa o Compan\\xEDa\",\n    name: \"empresa\",\n    value: empresa,\n    onChange: handleChange,\n    onBlur: handleBlur,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 17\n    }\n  })), errores.empresa && ___EmotionJSX(Errores, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 35\n    }\n  }, errores.empresa), ___EmotionJSX(Campo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 15\n    }\n  }, ___EmotionJSX(\"label\", {\n    htmlFor: \"imagen\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 17\n    }\n  }, \"Imagen\"), ___EmotionJSX(FileUploader, {\n    accept: \"image/*\",\n    id: \"imagen\",\n    name: \"imagen\",\n    randomizeFilename: true,\n    storageRef: firebase.storage.ref(\"productos\"),\n    onUploadStart: handleUploadStart,\n    onUploadError: handleUploadError,\n    onUploadSuccess: handleUploadSuccess,\n    onProgress: handleProgress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 17\n    }\n  })), ___EmotionJSX(Campo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 15\n    }\n  }, ___EmotionJSX(\"label\", {\n    htmlFor: \"url\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  }, \"URL\"), ___EmotionJSX(\"input\", {\n    type: \"url\",\n    id: \"url\",\n    placeholder: \"URL de tu producto\",\n    name: \"url\",\n    value: url,\n    onChange: handleChange,\n    onBlur: handleBlur,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 17\n    }\n  })), errores.url && ___EmotionJSX(Errores, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 31\n    }\n  }, errores.url)), ___EmotionJSX(\"fieldset\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 13\n    }\n  }, ___EmotionJSX(\"legend\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 15\n    }\n  }, \"Sobre tu producto\"), ___EmotionJSX(Campo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 15\n    }\n  }, ___EmotionJSX(\"label\", {\n    htmlFor: \"descripcion\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 17\n    }\n  }, \"Descripci\\xF3n\"), ___EmotionJSX(\"textarea\", {\n    id: \"descripcion\",\n    name: \"descripcion\",\n    value: descripcion,\n    onChange: handleChange,\n    onBlur: handleBlur,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  })), errores.descripcion && ___EmotionJSX(Errores, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 39\n    }\n  }, errores.descripcion)), error && ___EmotionJSX(Errores, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 23\n    }\n  }, error), ___EmotionJSX(InputSubmit, {\n    type: \"submit\",\n    value: \"Crear Producto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  })))));\n};\n\nexport default NuevoProducto;","map":{"version":3,"sources":["/Users/gerardorosas/Documents/producthunt/pages/nuevo-producto.js"],"names":["React","Fragment","useState","useContext","css","Layout","Router","useRouter","Formulario","Campo","InputSubmit","Errores","FirebaseContext","FileUploader","useValidacion","validarCrearProducto","STATE_INICIAL","nombre","empresa","url","descripcion","NuevoProducto","nombreimagen","guardarNombre","subiendo","guardarSubiendo","progreso","guardarProgreso","urlImagen","guardarUrlImagen","error","guardarError","valores","errores","handleChange","handleSubmit","handleBlur","crearProducto","imagen","router","usuario","firebase","push","producto","votos","comentarios","creado","Date","now","db","collection","add","handleUploadStart","handleProgress","handleUploadError","console","handleUploadSuccess","storage","ref","child","getDownloadURL","then","log"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useContext } from 'react';\nimport { css } from '@emotion/core';\nimport Layout from '../components/layout/Layout';\nimport Router, { useRouter } from 'next/router';\nimport { Formulario, Campo, InputSubmit, Errores } from '../components/UI/Formulario';\nimport { FirebaseContext } from '../firebase';\nimport FileUploader from 'react-firebase-file-uploader';\n\nimport useValidacion from '../hooks/useValidacion';\nimport validarCrearProducto from '../validacion/validarCrearProducto';\n\nconst STATE_INICIAL = {\n  nombre: '',\n  empresa: '',\n  //imagen: '',\n  url: '',\n  descripcion: ''\n}\n\nconst NuevoProducto = () => {\n\n  //State de las imagnes\n  const [ nombreimagen, guardarNombre ] = useState('');\n  const [ subiendo, guardarSubiendo ] = useState(false);\n  const [ progreso, guardarProgreso ] = useState(0);\n  const [ urlImagen, guardarUrlImagen ] = useState('');\n  \n  const [ error, guardarError ] = useState('');\n\n  const {valores, errores, handleChange, handleSubmit, handleBlur} = useValidacion\n  (STATE_INICIAL, validarCrearProducto, crearProducto);\n\n  const{ nombre, empresa, imagen, url, descripcion } = valores;\n\n  //Hook de routing para redireccionar\n  const router = useRouter();\n\n  //Context con las operaciones crud de firebase\n  const { usuario, firebase } = useContext(FirebaseContext);\n\n  async function crearProducto(){\n    //Si el usuario no esta auntenticado llevar al login\n    if(!usuario) {\n      return router.push('/login');\n    } \n\n    //Crear el objeto de nuevo producto\n    const producto = {\n      nombre,\n      empresa,\n      url,\n      urlImagen,\n      descripcion,\n      votos: 0,\n      comentarios : [],\n      creado: Date.now()\n    }\n\n    //Insertarlo en la base de datos\n    firebase.db.collection('productos').add(producto);\n\n  }\n\n  const handleUploadStart = () => {\n    guardarProgreso(0);\n    guardarSubiendo(true);\n  }\n\n  const handleProgress = progreso => guardarProgreso({ progreso });\n\n  const handleUploadError = error => {\n      guardarSubiendo(error);\n      console.error(error);\n  };\n\n  const handleUploadSuccess = nombre => {\n      guardarProgreso(100);\n      guardarSubiendo(false);\n      guardarNombre(nombre)\n      firebase\n          .storage\n          .ref(\"productos\")\n          .child(nombre)\n          .getDownloadURL()\n          .then(url => {\n            console.log(url);\n            guardarUrlImagen(url);\n          } );\n  };\n\n  return (\n    <div>\n      <Layout>\n        <Fragment>\n          <h1\n            css={css`\n              text-align: center;\n              margin-top: 5rem;\n            `}\n          >Nuevo Producto</h1>\n          <Formulario\n            onSubmit={handleSubmit}\n            noValidate\n          >\n\n            <fieldset>\n              <legend>Información del Producto</legend>\n            \n              <Campo>\n                <label htmlFor=\"nombre\">Nombre</label>\n                <input\n                  type=\"text\"\n                  id=\"nombre\"   \n                  placeholder=\"Tu nombre\"\n                  name=\"nombre\"\n                  value={nombre}\n                  onChange={handleChange}\n                  onBlur={handleBlur}\n                />\n              </Campo>\n\n              {errores.nombre && <Errores>{errores.nombre}</Errores>}\n    \n              <Campo>\n                <label htmlFor=\"empresa\">Empresa</label>\n                <input\n                  type=\"text\"\n                  id=\"empresa\"\n                  placeholder=\"Nombre Empresa o Companía\"\n                  name=\"empresa\"\n                  value={empresa}\n                  onChange={handleChange}\n                  onBlur={handleBlur}\n                />\n              </Campo>\n\n              {errores.empresa && <Errores>{errores.empresa}</Errores>}\n\n              <Campo>\n                <label htmlFor=\"imagen\">Imagen</label>\n                <FileUploader\n                  accept=\"image/*\"\n                  id=\"imagen\"\n                  name=\"imagen\"\n                  randomizeFilename\n                  storageRef={firebase.storage.ref(\"productos\")}\n                  onUploadStart={handleUploadStart}\n                  onUploadError={handleUploadError}\n                  onUploadSuccess={handleUploadSuccess}\n                  onProgress={handleProgress}\n                />\n              </Campo>\n\n              <Campo>\n                <label htmlFor=\"url\">URL</label>\n                <input\n                  type=\"url\"\n                  id=\"url\"\n                  placeholder=\"URL de tu producto\"\n                  name=\"url\"\n                  value={url}\n                  onChange={handleChange}\n                  onBlur={handleBlur}\n                />\n              </Campo>\n\n              {errores.url && <Errores>{errores.url}</Errores>}  \n\n            </fieldset>\n\n            <fieldset>\n              <legend>Sobre tu producto</legend>\n\n              \n              <Campo>\n                <label htmlFor=\"descripcion\">Descripción</label>\n                <textarea\n                  \n                  id=\"descripcion\"\n                  name=\"descripcion\"\n                  value={descripcion}\n                  onChange={handleChange}\n                  onBlur={handleBlur}\n                />\n              </Campo>\n\n              {errores.descripcion && <Errores>{errores.descripcion}</Errores>}\n            </fieldset>\n\n\n\n            {error && <Errores>{error}</Errores>}\n  \n            <InputSubmit\n              type=\"submit\"\n              value=\"Crear Producto\"\n            />\n  \n          </Formulario>\n        </Fragment>\n      </Layout>\n        \n    </div>\n  )\n}\n\nexport default NuevoProducto;"]},"metadata":{},"sourceType":"module"}